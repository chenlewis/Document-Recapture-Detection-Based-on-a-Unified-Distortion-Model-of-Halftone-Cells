%% lpi = 100, halftone angle = 45 degrees
% the number of gray levels is 72 + 1
%% clear work space
close all;
clear;
clc;
%%
% the half of the cell diagonal 
cell_half_diag = 6;
inverse_screen_freq = cell_half_diag * 2;
% because of the 45 degree tilting
num_gray_levels = (cell_half_diag * sqrt(2))^2 + 1;
% the single halftone cell (12x12)
screen_cell_mask = [0 0 0 0 0 1 1 0 0 0 0 0;...
                    0 0 0 0 1 1 1 1 0 0 0 0;...
                    0 0 0 1 1 1 1 1 1 0 0 0;...
                    0 0 1 1 1 1 1 1 1 1 0 0;...
                    0 1 1 1 1 1 1 1 1 1 1 0;...
                    1 1 1 1 1 1 1 1 1 1 1 1;...
                    0 1 1 1 1 1 1 1 1 1 1 0;...
                    0 0 1 1 1 1 1 1 1 1 0 0;...
                    0 0 0 1 1 1 1 1 1 0 0 0;...
                    0 0 0 0 1 1 1 1 0 0 0 0;...
                    0 0 0 0 0 1 1 0 0 0 0 0;...
                    0 0 0 0 0 0 0 0 0 0 0 0];
% calculat the distances (normalized)
[screen_cell_coord_x, screen_cell_coord_y] = meshgrid([-cell_half_diag:-1 1:cell_half_diag],...
                                                      [-cell_half_diag:-1 1:cell_half_diag]);
screen_cell_dist = sqrt(screen_cell_coord_x.^2 + screen_cell_coord_y.^2) .* screen_cell_mask;
screen_cell_dist_normal = screen_cell_dist ./ max(screen_cell_dist(:));
% construct the gray level (old, and might not be right)
t = fliplr(round(linspace(1, 255 - (255 / (num_gray_levels)), num_gray_levels - 1)));
% % another way of constructing the gray-scale 
% t = fliplr(round(linspace(0, 255 - (255 / (num_gray_levels - 1)), num_gray_levels - 1)));
% the single halftone cell
screen_cell = [0      0       0       0       0       t(71)   t(72)   0       0     0       0       0;...
               0      0       0       0       t(66)   t(59)   t(60)   t(67)   0     0       0       0;...
               0      0       0       t(54)   t(45)   t(37)   t(38)   t(46)   t(55)	0       0       0;...
               0      0       t(53)   t(41)   t(26)   t(17)   t(18)   t(27)   t(43)	t(56)   0       0;...
               0      t(65)   t(49)   t(25)   t(14)   t(7)    t(8)    t(15)   t(28)	t(51)   t(68)   0;...
               t(69)	t(57)   t(33)   t(21)   t(6)    t(1)    t(2)    t(9)    t(23)	t(35)   t(61)   t(70);...
               0      t(58)   t(34)   t(22)   t(5)    t(3)    t(4)    t(10)   t(24)	t(36)   t(62)   0;...
               0      0       t(50)   t(30)   t(13)   t(12)   t(11)   t(16)   t(29)	t(52)   0       0;...
               0      0       0       t(42)   t(31)   t(19)   t(20)   t(32)   t(44)	0       0       0;...
               0      0       0       0       t(47)   t(39)   t(40)   t(48)   0     0       0       0;...
               0      0       0       0       0       t(63)   t(64)   0       0     0       0       0;...
               0      0       0       0       0       0   	0       0       0       0       0       0;];
%% save the constructed screen
save('screen_cell_45_73.mat', 'screen_cell');